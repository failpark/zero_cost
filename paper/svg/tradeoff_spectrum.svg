<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" data-diagram-type="DESCRIPTION" height="247px" preserveAspectRatio="none" style="width:1450px;height:247px;background:#FEFEFE;" version="1.1" viewBox="0 0 1450 247" width="1450px" zoomAndPan="magnify"><title>When to Pay the Cost: A Computer Science Pattern</title><defs/><g><rect fill="#FEFEFE" height="247" style="stroke:none;stroke-width:1;" width="1450" x="0" y="0"/><g class="title" data-source-line="11"><text fill="#000000" font-family="Verdana" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="628.4717" x="406.5049" y="37.1182">When to Pay the Cost: A Computer Science Pattern</text></g><!--entity CT--><g class="entity" data-entity="CT" data-source-line="13" data-uid="ent0002" id="entity_CT"><rect fill="#CCE5FF" height="63.752" rx="2.5" ry="2.5" style="stroke:#333333;stroke-width:1;" width="132.8516" x="135.17" y="59.7373"/><text fill="#000000" font-family="Verdana" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="99.8496" x="145.17" y="81.8018">COMPILE TIME</text><text fill="#000000" font-family="Verdana" font-size="12" lengthAdjust="spacing" textLength="112.8516" x="145.17" y="96.3857">//Work done once,</text><text fill="#000000" font-family="Verdana" font-size="12" lengthAdjust="spacing" textLength="111.6563" x="145.17" y="110.9697">before execution//</text></g><!--entity WT--><g class="entity" data-entity="WT" data-source-line="14" data-uid="ent0003" id="entity_WT"><rect fill="#CCFFCC" height="63.752" rx="2.5" ry="2.5" style="stroke:#333333;stroke-width:1;" width="132.3652" x="398.41" y="59.7373"/><text fill="#000000" font-family="Verdana" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="84.2578" x="408.41" y="81.8018">WRITE TIME</text><text fill="#000000" font-family="Verdana" font-size="12" lengthAdjust="spacing" textLength="112.3652" x="408.41" y="96.3857">//Work done when</text><text fill="#000000" font-family="Verdana" font-size="12" lengthAdjust="spacing" textLength="93.5098" x="408.41" y="110.9697">data is stored//</text></g><!--entity ET--><g class="entity" data-entity="ET" data-source-line="15" data-uid="ent0004" id="entity_ET"><rect fill="#FFFFCC" height="63.752" rx="2.5" ry="2.5" style="stroke:#333333;stroke-width:1;" width="138.6055" x="625.29" y="59.7373"/><text fill="#000000" font-family="Verdana" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="93.8027" x="635.29" y="81.8018">ENCODE TIME</text><text fill="#000000" font-family="Verdana" font-size="12" lengthAdjust="spacing" textLength="118.6055" x="635.29" y="96.3857">//Work done before</text><text fill="#000000" font-family="Verdana" font-size="12" lengthAdjust="spacing" textLength="87.4395" x="635.29" y="110.9697">transmission//</text></g><!--entity RT--><g class="entity" data-entity="RT" data-source-line="16" data-uid="ent0005" id="entity_RT"><rect fill="#FFCCCC" height="63.752" rx="2.5" ry="2.5" style="stroke:#333333;stroke-width:1;" width="138.7637" x="1003.21" y="59.7373"/><text fill="#000000" font-family="Verdana" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="67.6934" x="1013.21" y="81.8018">RUN TIME</text><text fill="#000000" font-family="Verdana" font-size="12" lengthAdjust="spacing" textLength="118.7637" x="1013.21" y="96.3857">//Work done during</text><text fill="#000000" font-family="Verdana" font-size="12" lengthAdjust="spacing" textLength="69.041" x="1013.21" y="110.9697">execution//</text></g><!--entity RDT--><g class="entity" data-entity="RDT" data-source-line="17" data-uid="ent0006" id="entity_RDT"><rect fill="#FFCCCC" height="63.752" rx="2.5" ry="2.5" style="stroke:#333333;stroke-width:1;" width="132.3652" x="1278.41" y="59.7373"/><text fill="#000000" font-family="Verdana" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="75.2637" x="1288.41" y="81.8018">READ TIME</text><text fill="#000000" font-family="Verdana" font-size="12" lengthAdjust="spacing" textLength="112.3652" x="1288.41" y="96.3857">//Work done when</text><text fill="#000000" font-family="Verdana" font-size="12" lengthAdjust="spacing" textLength="109.4883" x="1288.41" y="110.9697">data is accessed//</text></g><!--entity R1--><g class="entity" data-entity="R1" data-source-line="24" data-uid="ent0011" id="entity_R1"><rect fill="#CCE5FF" height="49.168" rx="2.5" ry="2.5" style="stroke:#333333;stroke-width:1;" width="79.1855" x="12" y="187.6073"/><text fill="#000000" font-family="Verdana" font-size="12" lengthAdjust="spacing" textLength="26.918" x="22" y="209.6718">Rust</text><text fill="#000000" font-family="Verdana" font-size="12" lengthAdjust="spacing" textLength="59.1855" x="22" y="224.2557">Typestate</text></g><!--entity R2--><g class="entity" data-entity="R2" data-source-line="25" data-uid="ent0012" id="entity_R2"><rect fill="#CCFFCC" height="49.168" rx="2.5" ry="2.5" style="stroke:#333333;stroke-width:1;" width="60.4883" x="312.35" y="187.6073"/><text fill="#000000" font-family="Verdana" font-size="12" lengthAdjust="spacing" textLength="40.4883" x="322.35" y="209.6718">B-Tree</text><text fill="#000000" font-family="Verdana" font-size="12" lengthAdjust="spacing" textLength="34.3711" x="322.35" y="224.2557">Index</text></g><!--entity R3--><g class="entity" data-entity="R3" data-source-line="26" data-uid="ent0013" id="entity_R3"><rect fill="#FFFFCC" height="49.168" rx="2.5" ry="2.5" style="stroke:#333333;stroke-width:1;" width="71.5215" x="624.83" y="187.6073"/><text fill="#000000" font-family="Verdana" font-size="12" lengthAdjust="spacing" textLength="51.5215" x="634.83" y="209.6718">Huffman</text><text fill="#000000" font-family="Verdana" font-size="12" lengthAdjust="spacing" textLength="26.8125" x="634.83" y="224.2557">Tree</text></g><!--entity R4--><g class="entity" data-entity="R4" data-source-line="27" data-uid="ent0014" id="entity_R4"><rect fill="#FFCCCC" height="49.168" rx="2.5" ry="2.5" style="stroke:#333333;stroke-width:1;" width="117.3184" x="962.93" y="187.6073"/><text fill="#000000" font-family="Verdana" font-size="12" lengthAdjust="spacing" textLength="71.748" x="972.93" y="209.6718">Defensive C</text><text fill="#000000" font-family="Verdana" font-size="12" lengthAdjust="spacing" textLength="97.3184" x="972.93" y="224.2557">Runtime Checks</text></g><!--entity R5--><g class="entity" data-entity="R5" data-source-line="28" data-uid="ent0015" id="entity_R5"><rect fill="#FFCCCC" height="49.168" rx="2.5" ry="2.5" style="stroke:#333333;stroke-width:1;" width="97.7715" x="1346.71" y="187.6073"/><text fill="#000000" font-family="Verdana" font-size="12" lengthAdjust="spacing" textLength="68.6602" x="1356.71" y="209.6718">Hash Index</text><text fill="#000000" font-family="Verdana" font-size="12" lengthAdjust="spacing" textLength="77.7715" x="1356.71" y="224.2557">Point Lookup</text></g><g class="entity" data-entity="GMN21" data-source-line="37" data-uid="ent0022" id="entity_GMN21"><path d="M126.01,183.4873 L126.01,240.8853 A0,0 0 0 0 126.01,240.8853 L277.1687,240.8853 A0,0 0 0 0 277.1687,240.8853 L277.1687,193.4873 L267.1687,183.4873 L205.59,183.4873 L201.59,123.7673 L197.59,183.4873 L126.01,183.4873 A0,0 0 0 0 126.01,183.4873" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><path d="M267.1687,183.4873 L267.1687,193.4873 L277.1687,193.4873 L267.1687,183.4873" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="33.0649" x="132.01" y="201.5571">Rust</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="97.0938" x="165.0749" y="201.5571">: Type checker</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="127.9624" x="132.01" y="217.3564">proves correctness.</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="121.5957" x="132.01" y="233.1558">Zero runtime cost.</text></g><g class="entity" data-entity="GMN24" data-source-line="43" data-uid="ent0025" id="entity_GMN24"><path d="M407.83,183.4873 L407.83,240.8853 A0,0 0 0 0 407.83,240.8853 L589.3622,240.8853 A0,0 0 0 0 589.3622,240.8853 L589.3622,193.4873 L579.3622,183.4873 L494.53,183.4873 L473.53,123.7673 L486.53,183.4873 L407.83,183.4873 A0,0 0 0 0 407.83,183.4873" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><path d="M579.3622,183.4873 L579.3622,193.4873 L589.3622,193.4873 L579.3622,183.4873" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="48.731" x="413.83" y="201.5571">B-Tree</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="111.5029" x="462.561" y="201.5571">: Maintain sorted</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="126.0518" x="413.83" y="217.3564">structure on insert.</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="160.5322" x="413.83" y="233.1558">Fast range queries later.</text></g><g class="entity" data-entity="GMN27" data-source-line="49" data-uid="ent0028" id="entity_GMN27"><path d="M731.66,183.4873 L731.66,240.8853 A0,0 0 0 0 731.66,240.8853 L927.5316,240.8853 A0,0 0 0 0 927.5316,240.8853 L927.5316,193.4873 L917.5316,183.4873 L801.59,183.4873 L730.06,123.7673 L793.59,183.4873 L731.66,183.4873 A0,0 0 0 0 731.66,183.4873" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><path d="M917.5316,183.4873 L917.5316,193.4873 L927.5316,193.4873 L917.5316,183.4873" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="62.8291" x="737.66" y="201.5571">Huffman</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="112.0425" x="800.4891" y="201.5571">: Build frequency</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="89.3242" x="737.66" y="217.3564">table upfront.</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="156.9839" x="737.66" y="233.1558">Shorter messages later.</text></g><g class="entity" data-entity="GMN30" data-source-line="55" data-uid="ent0031" id="entity_GMN30"><path d="M1115.31,183.4873 L1115.31,240.8853 A0,0 0 0 0 1115.31,240.8853 L1311.8735,240.8853 A0,0 0 0 0 1311.8735,240.8853 L1311.8735,193.4873 L1301.8735,183.4873 L1184.17,183.4873 L1109.64,123.7673 L1176.17,183.4873 L1115.31,183.4873 A0,0 0 0 0 1115.31,183.4873" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><path d="M1301.8735,183.4873 L1301.8735,193.4873 L1311.8735,193.4873 L1301.8735,183.4873" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="85.8965" x="1121.31" y="201.5571">Defensive C</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="49.9878" x="1207.2065" y="201.5571">: Check</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="144.7583" x="1121.31" y="217.3564">state every operation.</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="175.5635" x="1121.31" y="233.1558">3.5&#215; instruction overhead.</text></g><!--link CT to WT--><g class="link" data-entity-1="CT" data-entity-2="WT" data-source-line="19" data-uid="lnk7" id="link_CT_WT"><path d="M268.37,91.6173 C311.68,91.6173 348.98,91.6173 392.29,91.6173" fill="none" id="CT-to-WT" style="stroke:#666666;stroke-width:1;"/><polygon fill="#666666" points="398.29,91.6173,389.29,87.6173,393.29,91.6173,389.29,95.6173,398.29,91.6173" style="stroke:#666666;stroke-width:1;"/></g><!--link WT to ET--><g class="link" data-entity-1="WT" data-entity-2="ET" data-source-line="20" data-uid="lnk8" id="link_WT_ET"><path d="M531.08,91.6173 C562.38,91.6173 587.67,91.6173 618.97,91.6173" fill="none" id="WT-to-ET" style="stroke:#666666;stroke-width:1;"/><polygon fill="#666666" points="624.97,91.6173,615.97,87.6173,619.97,91.6173,615.97,95.6173,624.97,91.6173" style="stroke:#666666;stroke-width:1;"/></g><!--link ET to RT--><g class="link" data-entity-1="ET" data-entity-2="RT" data-source-line="21" data-uid="lnk9" id="link_ET_RT"><path d="M764.36,91.6173 C843.83,91.6173 917.29,91.6173 996.76,91.6173" fill="none" id="ET-to-RT" style="stroke:#666666;stroke-width:1;"/><polygon fill="#666666" points="1002.76,91.6173,993.76,87.6173,997.76,91.6173,993.76,95.6173,1002.76,91.6173" style="stroke:#666666;stroke-width:1;"/></g><!--link RT to RDT--><g class="link" data-entity-1="RT" data-entity-2="RDT" data-source-line="22" data-uid="lnk10" id="link_RT_RDT"><path d="M1142.45,91.6173 C1187.72,91.6173 1226.99,91.6173 1272.27,91.6173" fill="none" id="RT-to-RDT" style="stroke:#666666;stroke-width:1;"/><polygon fill="#666666" points="1278.27,91.6173,1269.27,87.6173,1273.27,91.6173,1269.27,95.6173,1278.27,91.6173" style="stroke:#666666;stroke-width:1;"/></g><!--link CT to R1--><g class="link" data-entity-1="CT" data-entity-2="R1" data-source-line="30" data-uid="lnk16" id="link_CT_R1"><path d="M162.18,123.7673 C137.01,143.6673 104.87,169.0673 81.74,187.3573" fill="none" id="CT-R1" style="stroke:#666666;stroke-width:1;stroke-dasharray:7,7;"/></g><!--link WT to R2--><g class="link" data-entity-1="WT" data-entity-2="R2" data-source-line="31" data-uid="lnk17" id="link_WT_R2"><path d="M432.54,123.7673 C412.07,143.6673 385.93,169.0673 367.11,187.3573" fill="none" id="WT-R2" style="stroke:#666666;stroke-width:1;stroke-dasharray:7,7;"/></g><!--link ET to R3--><g class="link" data-entity-1="ET" data-entity-2="R3" data-source-line="32" data-uid="lnk18" id="link_ET_R3"><path d="M685.66,123.7673 C679.95,143.6673 672.67,169.0673 667.43,187.3573" fill="none" id="ET-R3" style="stroke:#666666;stroke-width:1;stroke-dasharray:7,7;"/></g><!--link RT to R4--><g class="link" data-entity-1="RT" data-entity-2="R4" data-source-line="33" data-uid="lnk19" id="link_RT_R4"><path d="M1059.19,123.7673 C1050.63,143.6673 1039.71,169.0673 1031.84,187.3573" fill="none" id="RT-R4" style="stroke:#666666;stroke-width:1;stroke-dasharray:7,7;"/></g><!--link RDT to R5--><g class="link" data-entity-1="RDT" data-entity-2="R5" data-source-line="34" data-uid="lnk20" id="link_RDT_R5"><path d="M1357.99,123.7673 C1366.55,143.6673 1377.48,169.0673 1385.34,187.3573" fill="none" id="RDT-R5" style="stroke:#666666;stroke-width:1;stroke-dasharray:7,7;"/></g><!--SRC=[ZLJRJjj047rcls8ARr49Wf0-y50975j4uYRZAbBbbyMU9Aiak-xi60XLlwCVr1_hh9qMfqGLjYplUcVEcNDcrnzuZYk4QgcDLNvXRAL9h-115uiPkTgMaLiwWeCa3dSdWh1WRMTBXEzgxy9HYRG97JINsakSvNlpWd1yedvqCZMHUmfPc_XFpIKXYWqBtcIE5jZ1dLw3L0UHytm6v_9ULJKZmNrXq1Oe0InJgzHhBVkzNdHxVJU-YY4RNyUzNcwFZYQE5b0wY-0axMDk7t3g206ViQZPE0dP1-qXok0WYk9XacmZJj9njXllIKhDRQbPW_7WML3B3TYa0KkIA0BOXejlejlHRhosiDmoQUjNnllNucB1IvA0jusMVhdP2LNMPEmij_-AJ1kSA7g34v-Ftg5H5mLw_rTbEdg5K-BV8PdPd0y_YtmrwKpZJCMTQPgfj3iTPLjDJ6lFkStM5NhMZ2tJyQxcN1ncX6BOs9RutCQT_F6z6tTPJwShBJf2U1itsENd2ATelNcKNPVRjBPiv714SomMliqwtUNUfVPpQ4h8xPqpbk7AkKLTjId3BOVwVP4Il0c3a-1A60o27s5mgeAbOJHKoZgMFU6OtGhSLFQd0f1EYJkztXa4Vw08jI79GaNk4JqKZa9bLhhKbwzVaHpGHaWX9wclq9OGaD_WJrhyrjF0S2q_1PO7l2F6KbOzKrrmJU4eWR4UYGDBeZs3xDaPmhSQoKWTIsaS_OSiRiasZGbi5xLPbZ0b50XRh6MPzOFOMrTJabz9uBcVXq88Lg9Epzx1ahOidRO6fgQXZHf91tn4MeEha7Gu9u5dq1_- -XdqDNBb8uYtD4TTThX-0m00]--></g></svg>